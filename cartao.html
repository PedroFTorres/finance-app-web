<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cartões</title>
  <link rel="icon" type="image/png" href="favicon.png">

<link rel="stylesheet" href="styles.css">
<link rel="stylesheet" href="cartao.css">

</head>

<body>

  <!-- TOPO -->
  <header class="top-header">
    <div class="top-bar">
      <h2>Cartões</h2>
    </div>

    <div class="top-bar">
      <button id="btn-back" class="btn-secondary">← Voltar</button>
      <span id="user-email"></span>
      <button id="btn-logout" class="danger">Sair</button>
    </div>
  </header>

  <!-- CONTEÚDO -->
 <main class="cartoes-page">
 <div class="cartoes-layout">

    <!-- SIDEBAR CARTÕES -->
    <aside class="cartoes-sidebar">

      <div class="sidebar-header">
       <h3>Meus Cartões</h3>
<p style="font-size:13px;color:#666;margin-bottom:8px">
  Selecione um cartão para ver a fatura
</p>

<div id="cards-list" class="cards-list"></div>
<button id="btn-new-card" class="btn-outline" style="margin-top:12px">
  + Novo cartão
</button>

      </div>


    </aside>
   
    <!-- CONTEÚDO FATURA -->
  <section class="cartoes-conteudo">

  <!-- FILTRO DE MÊS -->
  <div class="filtro-periodo" style="display:flex;gap:12px;align-items:center;margin-bottom:16px;">
    <button id="fat-prev" class="btn-secondary">◀</button>
    <strong id="fat-display"></strong>
    <button id="fat-next" class="btn-secondary">▶</button>
  </div>

  <!-- FATURA -->
  <h3 id="fatura-titulo"></h3>
  <p id="fatura-periodo"></p>
  <p id="fatura-total" class="valor-fatura"></p>

  <ul id="lista-fatura" class="lista-fatura"></ul>

  <!-- AÇÃO PRINCIPAL -->
  <div class="fatura-actions" style="margin-bottom:16px">
    <button id="btn-lancar-compra" class="btn-outline">
      ➕ Lançar compra
    </button>
  </div>

  <!-- AÇÕES DA FATURA -->
  <div class="box" style="margin-top:12px;padding:12px 16px">
    <div style="display:flex;gap:12px;flex-wrap:wrap">
      <button id="btn-fechar-fatura" class="btn-danger">
        Fechar Fatura
      </button>

      <button id="btn-gerar-despesa" class="btn-primary">
        Gerar Despesa
      </button>
    </div>
  </div>

</section>

      <!-- ===================== EDIÇÃO COMPRA PARCELADA ===================== -->
   
<div id="modal-editar-compra" class="modal hidden">
  <div class="modal-content" style="max-width:720px;">

    <h3>Editar compra parcelada</h3>

    <label>Descrição</label>
    <input id="edit-desc" />

    <label>Valor total</label>
    <input id="edit-valor-total" type="number" step="0.01" />

    <label>Data da compra</label>
    <input id="edit-data-inicial" type="date" />

    <label>Total de parcelas</label>
    <input id="edit-total-parcelas" type="number" disabled />

    <label>Categoria</label>
    <select id="edit-categoria"></select>

    <label>Cartão</label>
    <select id="edit-cartao"></select>

    <h4 style="margin-top:16px">Parcelas</h4>
    <ul id="lista-parcelas-editar" class="lista-parcelas"></ul>

    <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:16px">
      <button id="btn-salvar-edicao" class="btn-primary">
        Salvar alterações
      </button>
      <button id="btn-excluir-compra" class="btn-danger">
        Excluir compra
      </button>
      <button id="btn-fechar-edicao-compra" class="btn-secondary">
        Fechar
      </button>
    </div>

  </div>
</div>

 
</section>

      <!-- ========================= VIEW — LANÇAR COMPRA ========================= -->

<div id="modal-lancamento" class="modal hidden">
  <div class="modal-content">

    <h3>Lançar compra no cartão</h3>

    <label>Descrição</label>
    <input id="cart-desc" type="text" />

    <label>Valor</label>
    <input id="cart-valor" type="number" step="0.01" />

    <label>Data da compra</label>
    <input id="cart-data" type="date" />

    <label>Parcelas</label>
    <input id="cart-parcelas" type="number" min="1" value="1" />

    <label>Categoria</label>
    <select id="select-categoria-lanc-cartao"></select>

    <label>Fatura inicial</label>
    <select id="select-fatura-inicial"></select>

    <div style="display:flex;gap:10px;margin-top:16px">
      <button id="btn-add-purchase" class="btn-primary">
        Salvar compra
      </button>

      <button id="btn-cancel-purchase" class="btn-secondary">
        Cancelar
      </button>
    </div>

  </div>
</div>

    </section>

  </div>

</main>
    </section>

  </div>

</main>

<!-- SCRIPTS -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="supabase.js"></script>
<script src="cartao.js"></script>
  
<!-- ✅ MODAL FECHAR FATURA (LUGAR CORRETO) -->
<div id="modal-conta-fatura" class="modal hidden">
  <div class="modal-content">

    <h3>Fechar fatura</h3>

    <label>Conta para pagamento</label>
    <select id="conta-fatura-select"></select>

    <label style="margin-top:10px">Vencimento</label>
    <input type="date" id="conta-fatura-vencimento" />

    <div style="margin-top:16px;display:flex;gap:8px;justify-content:flex-end">
      <button id="conta-fatura-cancelar" class="btn-secondary">
        Cancelar
      </button>
      <button id="conta-fatura-confirmar" class="btn-primary">
        Confirmar
      </button>
    </div>

  </div>
</div>
  
<!-- ===================== MODAL EDITAR PARCELA ===================== -->
<div id="modal-editar-parcela" class="modal hidden">
  <div class="modal-content" style="max-width:420px;">

    <h3>Editar parcela</h3>

    <label>Valor da parcela</label>
    <input type="number" id="modal-parcela-valor" step="0.01">

    <label>Data da fatura</label>
    <input type="date" id="modal-parcela-data">

    <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:16px">
      <button id="modal-parcela-salvar" class="btn-primary">Salvar</button>
      <button id="modal-parcela-cancelar" class="btn-secondary">Cancelar</button>
    </div>

  </div>
</div>
<!-- ===================== MODAL NOVO CARTÃO ===================== -->
  
<div id="modal-new-card" class="modal hidden">
  <div class="modal-content">

    <h3>Novo cartão</h3>

    <label>Nome do cartão</label>
    <input id="card-nome" type="text" placeholder="Ex: Nubank, Itaú…" />

    <label>Limite</label>
    <input id="card-limite" type="number" step="0.01" />

    <label>Dia de fechamento</label>
    <input id="card-dia-fechamento" type="number" min="1" max="31" />

    <label>Dia de vencimento</label>
    <input id="card-dia-vencimento" type="number" min="1" max="31" />

    <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:16px">
      <button id="btn-cancel-card" class="btn-secondary">Cancelar</button>
      <button id="btn-save-card" class="btn-primary">Salvar</button>
    </div>

  </div>
</div>

</body>
</html>
