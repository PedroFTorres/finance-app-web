<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cartões</title>

<link rel="stylesheet" href="styles.css">
<link rel="stylesheet" href="cartao.css">

</head>

<body>

  <!-- TOPO -->
  <header class="top-header">
    <div class="top-bar">
      <h2>Cartões</h2>
    </div>

    <div class="top-bar">
      <button id="btn-back" class="btn-secondary">← Voltar</button>
      <span id="user-email"></span>
      <button id="btn-logout" class="danger">Sair</button>
    </div>
  </header>

  <!-- CONTEÚDO -->
 <main class="cartoes-page">
 <div class="cartoes-layout">

    <!-- SIDEBAR CARTÕES -->
    <aside class="cartoes-sidebar">

      <div class="sidebar-header">
       <h3>Meus Cartões</h3>
<p style="font-size:13px;color:#666;margin-bottom:8px">
  Selecione um cartão para ver a fatura
</p>

<div id="cards-list" class="cards-list"></div>
<button id="btn-new-card" class="btn-outline" style="margin-top:12px">
  + Novo cartão
</button>

      </div>


    </aside>

    <!-- CONTEÚDO FATURA -->
    <section class="cartoes-conteudo">

      <h3 id="fatura-titulo"></h3>
      <p id="fatura-periodo"></p>
      <p id="fatura-total" class="valor-fatura"></p>

      <ul id="lista-fatura" class="lista-fatura"></ul>
      
    <!-- AÇÃO PRINCIPAL -->
<div class="fatura-actions" style="margin-bottom:16px">
  <button id="btn-lancar-compra" class="btn-outline">
    ➕ Lançar compra
  </button>
</div>

      <!-- AÇÕES DA FATURA -->
<div class="box" style="margin-top:24px">

  <div style="display:flex;gap:12px;flex-wrap:wrap">
    
    <button id="btn-fechar-fatura" class="btn-danger">
      Fechar Fatura
    </button>

    <button id="btn-gerar-despesa" class="btn-primary">
      Gerar Despesa
    </button>

  </div>

</div>

      <!-- ===================== EDIÇÃO COMPRA PARCELADA ===================== -->
<section id="view-editar-compra" class="panel hidden">

  <div class="panel-header">
    <h2>Editar compra parcelada</h2>
    <button id="btn-voltar-edicao" class="btn-secondary">← Voltar</button>
  </div>

  <div class="form">
    <label>Descrição</label>
    <input id="edit-desc" />

    <label>Valor total</label>
    <input id="edit-valor-total" type="number" step="0.01" />

    <label>Data da compra</label>
    <input id="edit-data-inicial" type="date" />

    <label>Total de parcelas</label>
    <input id="edit-total-parcelas" type="number" disabled />

    <label>Categoria</label>
    <select id="edit-categoria"></select>

    <label>Cartão</label>
    <select id="edit-cartao"></select>
  </div>

  <h3>Parcelas</h3>
  <ul id="lista-parcelas-editar" class="lista-parcelas"></ul>

  <div class="actions-row">
    <button id="btn-salvar-edicao" class="btn-primary">Salvar alterações</button>
    <button id="btn-excluir-compra" class="btn-danger">Excluir compra</button>
  </div>

</section>

      <!-- ========================= VIEW — LANÇAR COMPRA ========================= -->

<div id="modal-lancamento" class="modal hidden">
  <div class="modal-content">

    <h3>Lançar compra no cartão</h3>

    <label>Descrição</label>
    <input id="cart-desc" type="text" />

    <label>Valor</label>
    <input id="cart-valor" type="number" step="0.01" />

    <label>Data da compra</label>
    <input id="cart-data" type="date" />

    <label>Parcelas</label>
    <input id="cart-parcelas" type="number" min="1" value="1" />

    <label>Categoria</label>
    <select id="select-categoria-lanc-cartao"></select>

    <label>Fatura inicial</label>
    <select id="select-fatura-inicial"></select>

    <div style="display:flex;gap:10px;margin-top:16px">
      <button id="btn-add-purchase" class="btn-primary">
        Salvar compra
      </button>

      <button id="btn-cancel-purchase" class="btn-secondary">
        Cancelar
      </button>
    </div>

  </div>
</div>

    </section>

  </div>

</main>
    </section>

  </div>

</main>

<!-- SCRIPTS -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="supabase.js"></script>
<script src="cartao.js"></script>
  
<!-- ✅ MODAL FECHAR FATURA (LUGAR CORRETO) -->
<div id="modal-conta-fatura" class="modal hidden">
  <div class="modal-content">

    <h3>Fechar fatura</h3>

    <label>Conta para pagamento</label>
    <select id="conta-fatura-select"></select>

    <label style="margin-top:10px">Vencimento</label>
    <input type="date" id="conta-fatura-vencimento" />

    <div style="margin-top:16px;display:flex;gap:8px;justify-content:flex-end">
      <button id="conta-fatura-cancelar" class="btn-secondary">
        Cancelar
      </button>
      <button id="conta-fatura-confirmar" class="btn-primary">
        Confirmar
      </button>
    </div>

  </div>
</div>

</body>
</html>
